import{f as F,i as q,h as C,j as z,e as A,g as H,F as L,_ as O,a as D,b as G,c as J,d as X,u as Y,n as Q,o as W,k as Z,m as ee}from"./data-provider-DopnOmTF.js";import{c as x}from"./createLucideIcon-BXtc9hHG.js";import{d as I,b as f,w as o,I as M,c as t,u as e,g as _,G as b,H as w,K as ae,r as te,v as g,o as u,T as se,a as S,F as P,y as h,t as v,U as le,q as k,J as T,s as ne}from"./index-Bm58MKXn.js";import{_ as $}from"./index-Bm2bU-no.js";import{_ as V,a as oe}from"./Input.vue_vue_type_script_setup_true_lang-D8q-072z.js";import{_ as R}from"./Card.vue_vue_type_script_setup_true_lang-Bn9A65-5.js";import{_ as N,a as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-74hoV6Ex.js";import{c as B,a as ie}from"./index-DmspJqqc.js";/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=x("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=x("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=x("ListXIcon",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"m19 10-4 4",key:"1tz659"}],["path",{d:"m15 10 4 4",key:"1n7nei"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=x("PackageOpenIcon",[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]]);/**
 * @license lucide-vue-next v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=x("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),me={class:"flex items-center flex-col justify-center"},ge=I({__name:"table",props:{table:{},isLoading:{type:Boolean},hideHeader:{type:Boolean}},setup(p){return(n,r)=>(u(),f(e(A),null,{default:o(()=>[n.hideHeader?M("",!0):(u(),f(e(F),{key:0},{default:o(()=>[(u(!0),_(b,null,w(n.table.getHeaderGroups(),i=>(u(),f(e(C),{key:i.id,class:"border-b"},{default:o(()=>[(u(!0),_(b,null,w(i.headers,s=>(u(),f(e(H),{key:s.id,style:se({width:`${s.getSize()}%`})},{default:o(()=>[s.isPlaceholder?M("",!0):(u(),f(e(L),{key:0,render:s.column.columnDef.header,props:s.getContext()},null,8,["render","props"]))]),_:2},1032,["style"]))),128))]),_:2},1024))),128))]),_:1})),t(e(q),{class:ae([n.isLoading?"animate-pulse":""])},{default:o(()=>{var i;return[(i=n.table.getRowModel().rows)!=null&&i.length?(u(!0),_(b,{key:0},w(n.table.getRowModel().rows,s=>(u(),f(e(C),{key:s.id},{default:o(()=>[(u(!0),_(b,null,w(s.getVisibleCells(),m=>(u(),f(e(z),{key:m.id,class:"md:break-all"},{default:o(()=>[t(e(L),{render:m.column.columnDef.cell,props:m.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128)):(u(),f(e(C),{key:1},{default:o(()=>[t(e(z),{colSpan:n.table.getAllColumns().length,class:"h-24 text-center"},{default:o(()=>[te(n.$slots,"empty-message",{},()=>[g("div",me,[t(e(de),{class:"size-12"}),r[0]||(r[0]=g("span",{class:"font-medium text-2xl"},"No data",-1))])])]),_:3},8,["colSpan"])]),_:3}))]}),_:3},8,["class"])]),_:3}))}}),fe={class:"flex justify-between max-sm:flex-col gap-4"},ve={class:"flex gap-2 items-center"},ye={class:"text-sm text-muted-foreground text-nowrap"},_e={class:"flex gap-2 items-center"},he={class:"flex gap-2 max-sm:justify-end max-sm:w-full"},be=I({__name:"pagination",props:{total:{},table:{},pagination:{}},emits:["update:page","update:pageSize"],setup(p,{emit:n}){const r=p,i=n,s=S(()=>r.pagination.pageIndex<0?1:r.pagination.pageIndex+1);function m(a){const l=a.target.value?Number(a.target.value)-1:0;Number.isNaN(l)||i("update:page",l<0?0:l)}function y(a){i("update:page",0),i("update:pageSize",Number(a))}return(a,l)=>(u(),_("div",fe,[g("div",ve,[g("div",ye,P(a.table.getPageCount())+' "page(s)" / '+P(a.total)+' "item(s)" ',1),t(e(O),{"default-value":"10","onUpdate:modelValue":y},{default:o(()=>[t(e(D),{class:"h-9 justify-between gap-2"},{default:o(()=>[g("div",null,[l[2]||(l[2]=h(" Per Page ")),t(e(G),{class:"flex-none"})])]),_:1}),t(e(J),null,{default:o(()=>[(u(),_(b,null,w(["10","20","50","100"],c=>t(e(X),{key:c,value:c},{default:o(()=>[h(P(c),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1})]),g("div",_e,[g("div",he,[t(e($),{class:"size-9 min-w-9 max-sm:w-full",variant:"outline",size:"icon",disabled:!a.table.getCanPreviousPage(),onClick:l[0]||(l[0]=c=>a.table.previousPage())},{default:o(()=>[t(e(re),{class:"h-4 w-4"})]),_:1},8,["disabled"]),t(e(V),{class:"w-20 h-9 max-sm:w-full",min:1,max:a.table.getPageCount(),"model-value":s.value,inputmode:"numeric",type:"number",onInput:m},null,8,["max","model-value"]),t(e($),{class:"size-9 min-w-9 max-sm:w-full",variant:"outline",size:"icon",disabled:!a.table.getCanNextPage(),onClick:l[1]||(l[1]=c=>a.table.nextPage())},{default:o(()=>[t(e(ue),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])]))}});function we(){const p=v({pageIndex:0,pageSize:10});function n({pageIndex:r,pageSize:i}){return p.value.pageIndex=r,p.value.pageSize=i,{pageIndex:r,pageSize:i}}return{pagination:p,setPagination:n}}const ke="syncraStorageColumnVisibility",xe=B(()=>({columnVisibility:ie(ke,{})})),j={key:"Key",value:"Value"},Ce=B(()=>{const{columnVisibility:p}=xe(),{pagination:n,setPagination:r}=we(),i=v([]),s=v(!1),m=v(null),y=v(1),a=v(0),l=S(()=>({page:n.value.pageIndex,perPage:n.value.pageSize})),c=async()=>{s.value=!0,m.value=null;try{const d=await ee("storage",l.value);i.value=d.data,y.value=Math.ceil(d.total/l.value.perPage),a.value=d.total}catch(d){m.value=d.message,console.log(d)}finally{s.value=!1}};le(c);const E=S(()=>[{accessorKey:j.key,size:20,header:()=>k("div",{},"Key"),cell:({row:d})=>k("div",d.original.Key)},{accessorKey:j.value,size:20,header:()=>k("div",{},"Value"),cell:({row:d})=>k("div",d.original.Value)}]),K=Y({get pageCount(){return y.value},get data(){return i.value},get columns(){return E.value},state:{get columnVisibility(){return p.value},get pagination(){return n.value}},manualPagination:!0,enableRowSelection:!0,onPaginationChange:d=>T(d,n),onColumnVisibilityChange:d=>T(d,p),getCoreRowModel:Z(),getFacetedRowModel:W(),getFacetedUniqueValues:Q()});return{isLoading:s,table:K,totalPairs:a,pagination:n,setPagination:r,fetchData:c}}),Pe={class:"p-4"},Se={class:"flex space-x-2 mb-4"},$e={class:"flex mr-[0.5em]"},Ve={class:"flex items-center justify-center h-[400px]"},je=I({__name:"Storage",setup(p){const n=v(""),r=v(""),{toast:i}=ne(),s=Ce(),m=async()=>{if(!n.value||!r.value){i({variant:"destructive",description:"Key and Value must not be empty."});return}const y=JSON.stringify({key:n.value,value:r.value}),a=async l=>{const c=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:y});if(!c.ok)throw new Error(`HTTP error! Status: ${c.status}`)};try{await a("http://localhost:8080/v1/storage"),i({description:"Pair added successfully."}),n.value="",r.value="",s.pagination.value.pageIndex=s.pagination.value.pageIndex}catch(l){console.error("First request failed, trying fallback...",l);try{await a("http://localhost:8081/v1/storage"),i({description:"Pair added successfully."}),n.value="",r.value="",s.pagination.value.pageIndex=s.pagination.value.pageIndex}catch(c){console.error("Both requests failed.",c),i({title:"Uh oh! Something went wrong.",description:"Could not add the pair after retrying.",variant:"destructive",action:k(oe,{altText:"Try again"},{default:()=>"Try again"})})}}};return(y,a)=>(u(),_("div",Pe,[t(e(R),{class:"mb-3"},{default:o(()=>[t(e(N),null,{default:o(()=>a[4]||(a[4]=[h("Add value")])),_:1}),t(e(U),null,{default:o(()=>[g("div",Se,[g("div",$e,[t(e(V),{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value=l),placeholder:"Key",class:"w-1/3 mr-2"},null,8,["modelValue"]),t(e(V),{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=l=>r.value=l),placeholder:"Value",class:"w-1/3 mr-2"},null,8,["modelValue"]),t(e($),{onClick:m,class:"h-10 w-20"},{default:o(()=>[t(e(pe),{class:"w-4 h-4"}),a[5]||(a[5]=h(" Add "))]),_:1})])])]),_:1})]),_:1}),t(e(R),null,{default:o(()=>[t(e(N),null,{default:o(()=>a[6]||(a[6]=[h("Storage")])),_:1}),t(e(U),null,{default:o(()=>[t(be,{total:e(s).totalPairs.value,table:e(s).table,pagination:e(s).pagination.value,"onUpdate:page":a[2]||(a[2]=l=>e(s).pagination.value.pageIndex=l),"onUpdate:pageSize":a[3]||(a[3]=l=>e(s).pagination.value.pageSize=l)},null,8,["total","table","pagination"]),t(ge,{table:e(s).table,"is-loading":e(s).isLoading.value},{"empty-message":o(()=>[g("div",Ve,[t(e(ce),{class:"w-6 h-6 mr-2"}),a[7]||(a[7]=h(" Storage is empty "))])]),_:1},8,["table","is-loading"])]),_:1})]),_:1})]))}});export{je as default};
